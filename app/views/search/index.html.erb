<p>Welcome to the Phenoscape phenotype database for ostariophysan fishes.</p>

<p>Begin typing to choose a search term from the popup menu.</p>
<!-- <div id="term_info"></div> -->
<table id="search_fields">
	<tr id="anatomy_search">
		<td class="field_label">Search anatomy:</td>
		<td>
			<div id="entityChoiceGroup">
				<input type="text" id="entityChoice">
				<div id="entityComplete"></div>
			</div>
		</td>
		<td>
			<input type="button" value="Search" onclick="submitAnatomy()">
		</td>
	</tr>
	<tr>
		<td class="or" colspan="2">or</td>
	</tr>
	<tr id="gene_search">
		<td class="field_label">Search genes:</td>
		<td>
			<div id="geneChoiceGroup">
				<input type="text" id="geneChoice">
				<div id="geneComplete"></div>
			</div>
		</td>
		<td>
			<input type="button" value="Search" onclick="submitGene()">
		</td>
	</tr>
	<tr>
		<td class="or" colspan="2">or</td>
	</tr>
	<tr id="taxonomy_search">
		<td class="field_label">Search taxonomy:</td>
		<td>
			<div id="taxonChoiceGroup">
				<input type="text" id="taxonChoice">
				<div id="taxonComplete"></div>
			</div>
		</td>
		<td>
			<input type="button" value="Search" onclick="submitTaxon()">
		</td>
	</tr>
</table>

<script type="text/javascript">
	var selectedAnatomy = {"id":null, "name":null};
	var selectedGene = {"id":null, "name":null};
	var selectedTaxon = {"id":null, "name":null};

	var entityAC = initAutocomplete($("entityChoice"), $("entityComplete"), "TAO");
	var geneAC = initAutocomplete($("geneChoice"), $("geneComplete"), "ZFIN");
	var taxonAC = initAutocomplete($("taxonChoice"), $("taxonComplete"), "TTO");
	var selectItem = function(storage, event, item) {
		var data = item[2];
		storage.id = data[1];
		storage.name = data[0];
	}
	entityAC.itemSelectEvent.subscribe(partial(selectItem, selectedAnatomy));
	geneAC.itemSelectEvent.subscribe(partial(selectItem, selectedGene));
	taxonAC.itemSelectEvent.subscribe(partial(selectItem, selectedTaxon));
	
	function submitAnatomy() {
		var href = "/search/anatomy/";
		if ((selectedAnatomy.id == null) || ($(entityChoice).value != selectedAnatomy.name)) {
			href += $(entityChoice).value + "?find=true";
		} else {
			href += selectedAnatomy.id;
		}
		location.href = (href);
	}
	
	function submitGene() {
		var href = "/search/gene/";
		if ((selectedGene.id == null) || ($(geneChoice).value != selectedGene.name)) {
			href += $(geneChoice).value + "?find=true";
		} else {
			href += selectedGene.id;
		}
		location.href = (href);
	}
	
	function submitTaxon() {
		var href = "/search/taxon/";
		if ((selectedTaxon.id == null) || ($(taxonChoice).value != selectedTaxon.name)) {
			href += $(taxonChoice).value + "?find=true";
		} else {
			href += selectedTaxon.id;
		}
		location.href = (href);
	}
</script>