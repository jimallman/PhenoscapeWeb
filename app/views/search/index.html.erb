<div id="sidebar">
	<div class="sidebar-box">
		<p>For further information about the Phenoscape project and project partners, please see our <a href="https://www.phenoscape.org/wiki/Main_Page">project wiki</a>.</p>
	</div>
	<div class="sidebar-box">
		<p>The Knowledgebase currently contains <span class="count">333,987</span> phenotype statements about <span class="count">2310</span> taxa, sourced from <span class="count">51</span> <a href="/about/bibliography/">publications</a>. as well as <span class="count">11,267</span> phenotype statements about <span class="count">2953</span> genes, retrieved from <a href="http://zfin.org">ZFIN</a>.  The data were last loaded into the Knowledgebase on <span class="timestamp"><%=h @timestamp %></span>.</p>
	</div>
</div>
<div id="main">
	<div id="search-forms">
		<div id="term_search">
			<h3 class="field_label">Search the Phenoscape Knowledgebase</h3>			
			<form id="termForm" action="" onsubmit="submitTerm(); return false;">
				<div id="termFormContent">
					<div id="termChoiceGroup">
						<input type="text" id="termChoice"><input id="termSubmit" type="submit" value="Search">
						<div id="termComplete"></div>
					</div>
					<p class="search-instructions">Type at least 4 characters to choose a search term from the popup menu.  If there are many matches, the autocomplete menu may take a few seconds to respond. Enter entity terms (e.g. basihyal bone), taxonomic names (e.g. Ictaluridae), or gene names or symbols (e.g. cadherin 6, cdh6).</p>
				</div>
			</form>
		</div>
	</div>
	<div class="navigation-group">
		<h3>Browse Data</h3>
		<ul>
			<li>Taxa</li>
			<li>Genes</li>
			<li>Entities (anatomy, behavior)</li>
			<li>Phenotypic qualities</li>
			<li>Publications</li>
		</ul>
	</div>
	<div class="navigation-group">
		<h3>Query Data</h3>
		<ul>
			<li>Taxonomic phenotype annotations</li>
			<li>Gene phenotype annotations</li>
			<li>Taxa</li>
			<li>Genes</li>
			<li>Publications</li>
		</ul>
	</div>
</div>
<script type="text/javascript">

	MochiKit.DOM.hideElement("upperTermForm");

	var selectedTerm = {"id":null, "name":null};
	var termAC = initAutocomplete($("termChoice"), $("termComplete"), [ONTOLOGY.TAO, ONTOLOGY.ZFIN, ONTOLOGY.TTO]);
	
	function selectItem(storage, event, item) {
		var data = item[2];
		storage.id = data[1];
		storage.name = data[0];
	}
	termAC.itemSelectEvent.subscribe(MochiKit.Base.partial(selectItem, selectedTerm));
	
	function submitTerm() {
		var href = null;
		if ((selectedTerm.id == null) || ($("termChoice").value != selectedTerm.name)) {
			href = URL.generalTerm($("termChoice").value);
		} else if (selectedTerm.id.indexOf(ONTOLOGY.TAO) == 0) {
			href = URL.entity(selectedTerm.id);
		} else if (selectedTerm.id.indexOf(ONTOLOGY.TTO) == 0) {
			href = URL.taxon(selectedTerm.id);
		} else if (selectedTerm.id.indexOf(ONTOLOGY.ZFIN) == 0) {
			href = URL.gene(selectedTerm.id);
		}
		location.href = href;
	}
	
</script>